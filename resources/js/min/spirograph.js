import{CurveDrawer}from"./curveDrawer.js";export class SpiroGraph{constructor(){this.colourOffset=Math.floor(3*Math.random()),this.blendModeOffset=Math.floor(3*Math.random()),this.tightness=randomInteger(-3,3),this.colourOffset=Math.floor(3*Math.random()),this.blendModeOffset=Math.floor(2*Math.random()),this.subSineAngleChange=randomInteger(4,6)*randomSign(),this.initialSineAngleChange=.04,this.initialSineAngle=0,this.numSines=randomInteger(5,6),this.renderCutoff=0,this.initialSineScale=width/2/3.5,this.lineThickness=1,this.maxRotations=1.1,this.subSineScale=randomReal(.5,.9),this.colour=color(0,0,0,3),this.sines,this.sineLines,this.angle=0,this.setup()}setup(){this.sines=new Array(this.numSines),this.sineLines=new Array(this.numSines);for(let i=0;i<this.sines.length;i++)this.sines[i]=this.angle,this.sineLines[i]=new CurveDrawer,colorMode(RGB),this.sineLines[i].line.colour=this.colour,this.sineLines[i].line.skipAmount=8,this.sineLines[i].line.lineThickness=this.lineThickness,this.sineLines[i].line.maxLength=100;curveTightness(this.tightness)}update(i,e,s,n){-1==s&&(s=this.scale),-1==n&&(n=this.drawingSpeed);let t=this.initialSineScale,h=this.initialSineAngleChange,o=s;if(this.sines[1]<2*Math.PI*this.maxRotations||0==this.maxRotations)for(var r=1;r<this.sines.length;r++){this.sines[r]+=h*n;let s=i+Math.sin(this.sines[r])*t*o,a=e+Math.cos(this.sines[r])*t*o,f=2;(this.blendModeOffset+r)%2==0?(f=2,blendMode(MULTIPLY)):(this.blendModeOffset+r)%2==1&&(f=3,blendMode(ADD));let d=255;if((this.colourOffset+r)%3==0?this.sineLines[r].line.fillColour=color(d,0,0,f):(this.colourOffset+r)%3==1?this.sineLines[r].line.fillColour=color(0,d,0,f):(this.colourOffset+r)%3==2&&(this.sineLines[r].line.fillColour=color(0,0,d,f)),r>=this.renderCutoff)for(var l=0;l<5;l++)this.sineLines[r].addPoint(s,a);i=s,e=a,t=this.initialSineScale*this.subSineScale*(1/r),h*=this.subSineAngleChange}}}function randomInteger(i,e){return i+Math.floor(Math.random()*(e-i+1))}function randomReal(i,e){return map(Math.random(),0,1,i,e)}function randomSign(){return Math.random()>.5?1:-1}